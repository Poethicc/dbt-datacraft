

============================== 2024-04-10 12:22:27.330387 | 188c7b80-c2f8-401e-a6ee-8f8843c6d5c4 ==============================
[0m12:22:27.330387 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:22:27.331950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:22:27.332158 [debug] [MainThread]: Tracking: tracking
[0m12:22:27.333595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b86b6a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b851d8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b851d8e20>]}
[0m12:22:27.334240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b86b6a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b851d8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b84bf5c90>]}
[0m12:22:27.334520 [debug] [MainThread]: Flushing usage events
[0m12:22:27.904158 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2024-04-10 12:22:40.818970 | f36b6f05-98ea-43f1-9051-fbdbaca19db8 ==============================
[0m12:22:40.818970 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:22:40.820221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m12:22:40.820343 [debug] [MainThread]: Tracking: tracking
[0m12:22:40.821756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0077d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00d4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00d40d0>]}
[0m12:22:40.830492 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w7mgoia6'
[0m12:22:40.830904 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:22:41.073766 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:22:41.074437 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:22:41.196036 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:22:41.200551 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/yu-iskw/dbt_unittest.json
[0m12:22:41.347837 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/yu-iskw/dbt_unittest.json 200
[0m12:22:41.352738 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:22:41.813307 [info ] [MainThread]:   Installed from version 1.1.1
[0m12:22:41.813690 [info ] [MainThread]:   Up to date!
[0m12:22:41.813977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f36b6f05-98ea-43f1-9051-fbdbaca19db8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00765f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0075360>]}
[0m12:22:41.814232 [info ] [MainThread]: Installing yu-iskw/dbt_unittest
[0m12:22:42.161067 [info ] [MainThread]:   Installed from version 0.3.3
[0m12:22:42.162124 [info ] [MainThread]:   Up to date!
[0m12:22:42.162463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f36b6f05-98ea-43f1-9051-fbdbaca19db8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0075c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00764a0>]}
[0m12:22:42.163337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0077b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0077700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0077880>]}
[0m12:22:42.163904 [debug] [MainThread]: Flushing usage events


============================== 2024-04-10 12:22:47.393476 | 2b3d915b-3573-4625-8517-a090c24c9886 ==============================
[0m12:22:47.393476 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:22:47.394841 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:22:47.394968 [debug] [MainThread]: Tracking: tracking
[0m12:22:47.397164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bc0e1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bc17b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bc17b010>]}
[0m12:22:47.416760 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:22:47.417387 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:22:47.417812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b3d915b-3573-4625-8517-a090c24c9886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bc17a230>]}
[0m12:22:48.611338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3d915b-3573-4625-8517-a090c24c9886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bb6b1ba0>]}
[0m12:22:48.626370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b3d915b-3573-4625-8517-a090c24c9886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bb944e20>]}
[0m12:22:48.626778 [info ] [MainThread]: Found 0 models, 8 tests, 0 snapshots, 0 analyses, 527 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:22:48.627031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3d915b-3573-4625-8517-a090c24c9886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bb665540>]}
[0m12:22:48.628193 [info ] [MainThread]: 
[0m12:22:48.628759 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:22:48.629065 [debug] [MainThread]: Command end result
[0m12:22:48.637914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bc12b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bb945d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bb6b1480>]}
[0m12:22:48.638370 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:56:40.302432 | adfbbce0-541a-40d5-afa9-0a5d06b86cdf ==============================
[0m14:56:40.302432 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:56:40.304889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m14:56:40.305186 [debug] [MainThread]: Tracking: tracking
[0m14:56:40.316426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fbbd8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fb67b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fb67afe0>]}
[0m14:56:40.341570 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:56:40.477264 [debug] [MainThread]: Partial parsing enabled: 41 files deleted, 44 files added, 4 files changed.
[0m14:56:40.477639 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/normalize_name.sql
[0m14:56:40.477798 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_from_default_dict.sql
[0m14:56:40.477922 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/etlcraft_defaults.sql
[0m14:56:40.478042 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/dataset.sql
[0m14:56:40.478161 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_utmhash.sql
[0m14:56:40.478278 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/old_custom_hash.sql
[0m14:56:40.478395 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/custom_union_relations.sql
[0m14:56:40.478511 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/like_query_cycle.sql
[0m14:56:40.478631 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/fix_alias.sql
[0m14:56:40.478761 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/zero_date.sql
[0m14:56:40.478880 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/link_hash.sql
[0m14:56:40.478997 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/incremental/incremental.sql
[0m14:56:40.479113 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/link/link.sql
[0m14:56:40.479238 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/json_list_keys.sql
[0m14:56:40.479359 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/json_extract.sql
[0m14:56:40.479478 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_vkads_datestat.sql
[0m14:56:40.479596 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_ym_events.sql
[0m14:56:40.479716 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/array.sql
[0m14:56:40.479915 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_column_count_in_subquery.sql
[0m14:56:40.480060 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/full/full.sql
[0m14:56:40.480229 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/check_table_exists.sql
[0m14:56:40.480390 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_min_max_date.sql
[0m14:56:40.480515 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_relations_dict.sql
[0m14:56:40.480650 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_adsourcedirty.sql
[0m14:56:40.480768 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/clickhouse-adapters.sql
[0m14:56:40.480884 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/custom_union_relations_source.sql
[0m14:56:40.481001 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/find_incremental_datetime_field.sql
[0m14:56:40.481117 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/combine/combine.sql
[0m14:56:40.481233 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/hash/hash.sql
[0m14:56:40.481349 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join.sql
[0m14:56:40.481463 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/entity_hash.sql
[0m14:56:40.481578 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/normalize/normalize.sql
[0m14:56:40.481695 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/cast_datetime_field.sql
[0m14:56:40.481815 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_utmcraft_registry_utmhashregistry.sql
[0m14:56:40.481934 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_appmetrica_registry_appprofilematching.sql
[0m14:56:40.482050 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/surrogate_key.sql
[0m14:56:40.482164 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_appmetrica_events.sql
[0m14:56:40.482279 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_sheets_periodstat.sql
[0m14:56:40.482394 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/test_var.sql
[0m14:56:40.482554 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/hash/hash_test.sql
[0m14:56:40.482699 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/metadata/metadata.sql
[0m14:56:40.482820 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_mt_datestat.sql
[0m14:56:40.482948 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/cast_date_field.sql
[0m14:56:40.483063 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_yd_datestat.sql
[0m14:56:40.483162 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hash.sql
[0m14:56:40.483319 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/array.sql
[0m14:56:40.483413 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_vkads_datestat.sql
[0m14:56:40.483501 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_appmetrica_registry_app_profile_matching.sql
[0m14:56:40.483588 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join.sql
[0m14:56:40.483673 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_mt_datestat.sql
[0m14:56:40.483761 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/like_query_cycle.sql
[0m14:56:40.483849 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_adsourcedirty.sql
[0m14:56:40.483937 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_utmhash.sql
[0m14:56:40.484024 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hashes/entity_hash.sql
[0m14:56:40.484109 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_ym_events.sql
[0m14:56:40.484203 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/json_extract.sql
[0m14:56:40.484289 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/misc/make_link.sql
[0m14:56:40.484374 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_appmetrica_events.sql
[0m14:56:40.484463 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://tests/test_get_min_max_date.sql
[0m14:56:40.484559 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/json_list_keys.sql
[0m14:56:40.484645 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/combine.sql
[0m14:56:40.484732 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/join_yd_datestat.sql
[0m14:56:40.484819 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_min_max_date.sql
[0m14:56:40.484906 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/normalize.sql
[0m14:56:40.484990 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/test_var.sql
[0m14:56:40.485391 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/misc/metadata.sql
[0m14:56:40.485493 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/cast_date_field.sql
[0m14:56:40.485661 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_from_default_dict.sql
[0m14:56:40.485756 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hashes/old_custom_hash.sql
[0m14:56:40.485886 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hash_test.sql
[0m14:56:40.485986 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/find_incremental_datetime_field.sql
[0m14:56:40.486089 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/check_table_exists.sql
[0m14:56:40.486178 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/cast_datetime_field.sql
[0m14:56:40.486534 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/clickhouse-adapters.sql
[0m14:56:40.486809 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hashes/surrogate_key.sql
[0m14:56:40.486903 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/misc/make_hub.sql
[0m14:56:40.487037 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/normalize_name.sql
[0m14:56:40.487131 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/etlcraft_defaults.sql
[0m14:56:40.487218 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/incremental.sql
[0m14:56:40.487347 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_column_count_in_subquery.sql
[0m14:56:40.487437 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/hashes/link_hash.sql
[0m14:56:40.487521 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/dataset.sql
[0m14:56:40.487648 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/get_relations_dict.sql
[0m14:56:40.487736 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://tests/test_normalize.sql
[0m14:56:40.487877 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://macros/custom_union_relations.sql
[0m14:56:40.488059 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/dataset/create_dataset.sql
[0m14:56:40.488290 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_prepare_with_qid.sql
[0m14:56:40.488417 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m14:56:40.488567 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_glue.sql
[0m14:56:40.892784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adfbbce0-541a-40d5-afa9-0a5d06b86cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fab47d30>]}
[0m14:56:40.906534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adfbbce0-541a-40d5-afa9-0a5d06b86cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4faccde70>]}
[0m14:56:40.906884 [info ] [MainThread]: Found 0 models, 6 tests, 0 snapshots, 0 analyses, 535 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:56:40.907134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfbbce0-541a-40d5-afa9-0a5d06b86cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fbbd8df0>]}
[0m14:56:40.908400 [info ] [MainThread]: 
[0m14:56:40.910201 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:56:40.910532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfbbce0-541a-40d5-afa9-0a5d06b86cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4facdb0a0>]}
[0m14:56:40.911006 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:56:40.911260 [info ] [MainThread]: 
[0m14:56:40.916801 [debug] [Thread-1 (]: Began running node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:40.917192 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:40.918347 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_find_incremental_datetime_field'
[0m14:56:40.918991 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_column_count_in_subquery'
[0m14:56:40.919292 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:40.919519 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:40.926567 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_find_incremental_datetime_field"
[0m14:56:40.930327 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_column_count_in_subquery"
[0m14:56:40.933476 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (compile): 2024-06-07 14:56:40.919702 => 2024-06-07 14:56:40.933348
[0m14:56:40.933850 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:40.934047 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (execute): 2024-06-07 14:56:40.933990 => 2024-06-07 14:56:40.934008
[0m14:56:40.935486 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:40.935861 [debug] [Thread-1 (]: Began running node test.etlcraft.test_get_from_default_dict
[0m14:56:40.936940 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_from_default_dict'
[0m14:56:40.937322 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (compile): 2024-06-07 14:56:40.927128 => 2024-06-07 14:56:40.937253
[0m14:56:40.937739 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_get_from_default_dict
[0m14:56:40.938080 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:40.947095 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_get_from_default_dict"
[0m14:56:40.947547 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (execute): 2024-06-07 14:56:40.947459 => 2024-06-07 14:56:40.947476
[0m14:56:40.948952 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:40.949367 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_relations_dist
[0m14:56:40.950175 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_relations_dist'
[0m14:56:40.950567 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (compile): 2024-06-07 14:56:40.938362 => 2024-06-07 14:56:40.950501
[0m14:56:40.951092 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_relations_dist
[0m14:56:40.952071 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_get_from_default_dict
[0m14:56:40.956643 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:56:40.957346 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (execute): 2024-06-07 14:56:40.957168 => 2024-06-07 14:56:40.957200
[0m14:56:40.959084 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_get_from_default_dict
[0m14:56:40.960308 [debug] [Thread-1 (]: Began running node test.etlcraft.test_json_list_keys
[0m14:56:40.961569 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_json_list_keys'
[0m14:56:40.962010 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_json_list_keys
[0m14:56:40.965011 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_json_list_keys"
[0m14:56:40.965600 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_json_list_keys (compile): 2024-06-07 14:56:40.962154 => 2024-06-07 14:56:40.965508
[0m14:56:40.965865 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_json_list_keys
[0m14:56:40.966043 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_json_list_keys (execute): 2024-06-07 14:56:40.965994 => 2024-06-07 14:56:40.966006
[0m14:56:40.966575 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_json_list_keys
[0m14:56:40.966878 [debug] [Thread-1 (]: Began running node test.etlcraft.test_normalize_name
[0m14:56:40.967886 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_normalize_name'
[0m14:56:40.968726 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_normalize_name
[0m14:56:40.977087 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_normalize_name"
[0m14:56:40.978318 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (compile): 2024-06-07 14:56:40.968893 => 2024-06-07 14:56:40.978116
[0m14:56:40.978905 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_normalize_name
[0m14:56:40.979109 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (execute): 2024-06-07 14:56:40.979048 => 2024-06-07 14:56:40.979062
[0m14:56:40.979709 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_normalize_name
[0m14:56:41.638120 [debug] [Thread-2 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_relations_dist: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_relations_dist"} */

    SELECT 
        table, 
        groupArray(name) AS fields
    
    FROM (
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
)
    
    WHERE database = '' AND table LIKE 'incremental_testsourcetypename_testtemplatename_%'
    GROUP BY table

...
[0m14:56:41.671171 [debug] [Thread-2 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m14:56:41.672590 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_relations_dist"
[0m14:56:41.673412 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_relations_dist (compile): 2024-06-07 14:56:40.952418 => 2024-06-07 14:56:41.673331
[0m14:56:41.673617 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_relations_dist
[0m14:56:41.673772 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_relations_dist (execute): 2024-06-07 14:56:41.673715 => 2024-06-07 14:56:41.673726
[0m14:56:41.674324 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_relations_dist
[0m14:56:41.676264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:41.676570 [debug] [MainThread]: Connection 'test.etlcraft.test_normalize_name' was properly closed.
[0m14:56:41.676676 [debug] [MainThread]: Connection 'test.etlcraft.test_get_relations_dist' was left open.
[0m14:56:41.676821 [debug] [MainThread]: On test.etlcraft.test_get_relations_dist: Close
[0m14:56:41.677205 [debug] [MainThread]: Command end result
[0m14:56:41.687248 [info ] [MainThread]: Done.
[0m14:56:41.687904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4fab43be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4faeec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4faeedff0>]}
[0m14:56:41.688235 [debug] [MainThread]: Flushing usage events


============================== 2024-06-07 14:56:55.372906 | 573114b1-42c0-4f66-b267-1cdd67305fb5 ==============================
[0m14:56:55.372906 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:56:55.374501 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m14:56:55.374684 [debug] [MainThread]: Tracking: tracking
[0m14:56:55.378197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6ed0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c697b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c697afe0>]}
[0m14:56:55.396891 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:56:55.431870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:55.432324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:55.438049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573114b1-42c0-4f66-b267-1cdd67305fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5e280d0>]}
[0m14:56:55.450145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573114b1-42c0-4f66-b267-1cdd67305fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5ff2800>]}
[0m14:56:55.450587 [info ] [MainThread]: Found 0 models, 6 tests, 0 snapshots, 0 analyses, 535 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:56:55.450861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573114b1-42c0-4f66-b267-1cdd67305fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5ff2830>]}
[0m14:56:55.451981 [info ] [MainThread]: 
[0m14:56:55.453805 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:56:55.454196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573114b1-42c0-4f66-b267-1cdd67305fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5ff2560>]}
[0m14:56:55.454781 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:56:55.455109 [info ] [MainThread]: 
[0m14:56:55.466306 [debug] [Thread-1 (]: Began running node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:55.466746 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:55.467317 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_find_incremental_datetime_field'
[0m14:56:55.467955 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_column_count_in_subquery'
[0m14:56:55.468328 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:55.468604 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:55.484136 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_column_count_in_subquery"
[0m14:56:55.495250 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_find_incremental_datetime_field"
[0m14:56:55.496120 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (compile): 2024-06-07 14:56:55.479776 => 2024-06-07 14:56:55.495979
[0m14:56:55.496489 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:55.496701 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (execute): 2024-06-07 14:56:55.496641 => 2024-06-07 14:56:55.496658
[0m14:56:55.498338 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_column_count_in_subquery
[0m14:56:55.498741 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (compile): 2024-06-07 14:56:55.468805 => 2024-06-07 14:56:55.498620
[0m14:56:55.499464 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_from_default_dict
[0m14:56:55.500021 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:55.500849 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_from_default_dict'
[0m14:56:55.501168 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (execute): 2024-06-07 14:56:55.501097 => 2024-06-07 14:56:55.501110
[0m14:56:55.501590 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_from_default_dict
[0m14:56:55.502289 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_find_incremental_datetime_field
[0m14:56:55.508674 [debug] [Thread-1 (]: Began running node test.etlcraft.test_get_relations_dist
[0m14:56:55.511722 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_from_default_dict"
[0m14:56:55.513218 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_relations_dist'
[0m14:56:55.514298 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_get_relations_dist
[0m14:56:55.520112 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_from_default_dict (compile): 2024-06-07 14:56:55.502742 => 2024-06-07 14:56:55.519921
[0m14:56:55.520913 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_from_default_dict
[0m14:56:55.526694 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_from_default_dict (execute): 2024-06-07 14:56:55.526503 => 2024-06-07 14:56:55.526539
[0m14:56:55.533832 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_from_default_dict
[0m14:56:55.534452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:55.535239 [debug] [Thread-2 (]: Began running node test.etlcraft.test_json_list_keys
[0m14:56:55.536379 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_json_list_keys'
[0m14:56:55.536634 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_json_list_keys
[0m14:56:55.543486 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_json_list_keys"
[0m14:56:55.545066 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_json_list_keys (compile): 2024-06-07 14:56:55.536769 => 2024-06-07 14:56:55.544915
[0m14:56:55.545690 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_json_list_keys
[0m14:56:55.546191 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_json_list_keys (execute): 2024-06-07 14:56:55.546065 => 2024-06-07 14:56:55.546091
[0m14:56:55.547689 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_json_list_keys
[0m14:56:55.549359 [debug] [Thread-2 (]: Began running node test.etlcraft.test_normalize_name
[0m14:56:55.550979 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_normalize_name'
[0m14:56:55.551312 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_normalize_name
[0m14:56:55.567321 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_normalize_name"
[0m14:56:55.569782 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_normalize_name (compile): 2024-06-07 14:56:55.551455 => 2024-06-07 14:56:55.569618
[0m14:56:55.570660 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_normalize_name
[0m14:56:55.570868 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_normalize_name (execute): 2024-06-07 14:56:55.570815 => 2024-06-07 14:56:55.570827
[0m14:56:55.571409 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_normalize_name
[0m14:56:55.970478 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_relations_dist: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_relations_dist"} */

    SELECT 
        table, 
        groupArray(name) AS fields
    
    FROM (
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
)
    
    WHERE database = '' AND table LIKE 'incremental_testsourcetypename_testtemplatename_%'
    GROUP BY table

...
[0m14:56:55.990664 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m14:56:55.991978 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_get_relations_dist"
[0m14:56:55.992367 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_relations_dist (compile): 2024-06-07 14:56:55.514690 => 2024-06-07 14:56:55.992299
[0m14:56:55.992554 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_get_relations_dist
[0m14:56:55.992878 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_relations_dist (execute): 2024-06-07 14:56:55.992767 => 2024-06-07 14:56:55.992790
[0m14:56:55.993632 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_get_relations_dist
[0m14:56:55.995216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:55.995579 [debug] [MainThread]: Connection 'test.etlcraft.test_get_relations_dist' was left open.
[0m14:56:55.995841 [debug] [MainThread]: On test.etlcraft.test_get_relations_dist: Close
[0m14:56:55.995948 [debug] [MainThread]: Connection 'test.etlcraft.test_normalize_name' was properly closed.
[0m14:56:55.996300 [debug] [MainThread]: Command end result
[0m14:56:56.004787 [info ] [MainThread]: Done.
[0m14:56:56.014501 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m14:56:56.014782 [info ] [MainThread]: Building catalog
[0m14:56:56.024626 [info ] [MainThread]: Catalog written to /home/natalia/dbt-etlcraft/target/catalog.json
[0m14:56:56.025482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6ed0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5ff1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c5ebd7e0>]}
[0m14:56:56.025761 [debug] [MainThread]: Flushing usage events
[0m14:56:56.730155 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2024-06-07 14:58:52.973790 | a2545a06-f6a8-4c42-98f5-8542ddcb68cf ==============================
[0m14:58:52.973790 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:58:52.975344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8001, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m14:58:52.975573 [debug] [MainThread]: Tracking: tracking
[0m14:58:52.977636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61ac07a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61b2b9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61b9d8e50>]}
[0m14:58:52.980085 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
[0m14:58:52.980514 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
[0m14:58:52.980682 [info ] [MainThread]: 
[0m14:58:52.980845 [info ] [MainThread]: 
[0m14:58:52.980981 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:03:23.619145 [debug] [MainThread]: Flushing usage events
[0m15:03:26.654355 [info ] [MainThread]: ctrl-c


============================== 2024-07-10 12:39:11.981632 | d679f6bc-f33f-488a-b176-3a7362aa101e ==============================
[0m12:39:11.981632 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:39:11.983955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:39:11.984415 [debug] [MainThread]: Tracking: tracking
[0m12:39:11.987011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2627ee1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2627f83040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2627f83010>]}
[0m12:39:12.011754 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:39:12.141585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 46 files changed.
[0m12:39:12.142021 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_features.sql
[0m12:39:12.142193 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/metadata/metadata_1.sql
[0m12:39:12.142321 [debug] [MainThread]: Partial parsing: added file: etlcraft://tests/test_get_min_max_date.sql
[0m12:39:12.142445 [debug] [MainThread]: Partial parsing: added file: etlcraft://tests/test_normalize.sql
[0m12:39:12.142563 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_yd_datestat_smart.sql
[0m12:39:12.142679 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/metadata/metadata_maxi.sql
[0m12:39:12.142797 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/fix_phone.sql
[0m12:39:12.142914 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/other/get_table_types_sql.sql
[0m12:39:12.143080 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_yd_datestat.sql
[0m12:39:12.143512 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/etlcraft_defaults.sql
[0m12:39:12.143692 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/hash/hash.sql
[0m12:39:12.143817 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/incremental/incremental.sql
[0m12:39:12.143985 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_ym_events.sql
[0m12:39:12.144314 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/get_min_max_date.sql
[0m12:39:12.144565 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_appmetrica_events.sql
[0m12:39:12.144734 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_create_events.sql
[0m12:39:12.144893 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_utmcraft_registry_utmhashregistry.sql
[0m12:39:12.145303 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/clickhouse-adapters.sql
[0m12:39:12.145474 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_add_row_number.sql
[0m12:39:12.145632 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_glue.sql
[0m12:39:12.145753 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join.sql
[0m12:39:12.145906 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph.sql
[0m12:39:12.146061 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_lookup.sql
[0m12:39:12.146215 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/custom_union_relations_source.sql
[0m12:39:12.146793 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/metadata/metadata.sql
[0m12:39:12.146999 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/link_hash.sql
[0m12:39:12.147163 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_final_table.sql
[0m12:39:12.147322 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_create_missed_steps.sql
[0m12:39:12.147446 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_tuples.sql
[0m12:39:12.147564 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/combine/combine.sql
[0m12:39:12.147720 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/link/link.sql
[0m12:39:12.147840 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/normalize/normalize.sql
[0m12:39:12.147957 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_sheets_periodstat.sql
[0m12:39:12.148108 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/old_multiver__attr_create_missed_steps.sql
[0m12:39:12.148226 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_mt_datestat.sql
[0m12:39:12.148342 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/old_multiver__attr_create_events.sql
[0m12:39:12.148492 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_qid.sql
[0m12:39:12.148724 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_vkads_datestat.sql
[0m12:39:12.148892 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_unique.sql
[0m12:39:12.149083 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/zero_date.sql
[0m12:39:12.149241 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr.sql
[0m12:39:12.149361 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/old_multiver__attr_find_new_period.sql
[0m12:39:12.149482 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_find_new_period.sql
[0m12:39:12.149633 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_calculate_period_number.sql
[0m12:39:12.149763 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/old_multiver__attr_add_row_number.sql
[0m12:39:12.149921 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/dataset/create_dataset.sql
[0m12:39:12.150042 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/hash/hash_test.sql
[0m12:39:12.150195 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_prepare_with_qid.sql
[0m12:39:12.150349 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/graphs/graph_edge.sql
[0m12:39:12.150472 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_join_to_attr_prepare_with_qid.sql
[0m12:39:12.150590 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/join/join_appmetrica_registry_appprofilematching.sql
[0m12:39:12.150707 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/attr_model.sql
[0m12:39:12.150858 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/attr/old_multiver__attr_calculate_period_number.sql
[0m12:39:12.150976 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/full/full.sql
[0m12:39:12.578641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd679f6bc-f33f-488a-b176-3a7362aa101e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262740b340>]}
[0m12:39:12.593256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd679f6bc-f33f-488a-b176-3a7362aa101e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26275cfee0>]}
[0m12:39:12.594049 [info ] [MainThread]: Found 0 models, 8 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:39:12.594548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd679f6bc-f33f-488a-b176-3a7362aa101e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2627ee1c90>]}
[0m12:39:12.596728 [info ] [MainThread]: 
[0m12:39:12.598710 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:39:12.599591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd679f6bc-f33f-488a-b176-3a7362aa101e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26275ce830>]}
[0m12:39:12.600243 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:39:12.600525 [info ] [MainThread]: 
[0m12:39:12.607971 [debug] [Thread-1 (]: Began running node test.etlcraft.test_find_incremental_datetime_field
[0m12:39:12.608524 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_column_count_in_subquery
[0m12:39:12.609211 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_find_incremental_datetime_field'
[0m12:39:12.610720 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_column_count_in_subquery'
[0m12:39:12.611751 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_find_incremental_datetime_field
[0m12:39:12.612460 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_column_count_in_subquery
[0m12:39:12.620665 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_find_incremental_datetime_field"
[0m12:39:12.624490 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_column_count_in_subquery"
[0m12:39:12.628489 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (compile): 2024-07-10 12:39:12.612991 => 2024-07-10 12:39:12.627980
[0m12:39:12.629859 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_find_incremental_datetime_field
[0m12:39:12.630385 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (execute): 2024-07-10 12:39:12.630176 => 2024-07-10 12:39:12.630280
[0m12:39:12.630816 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (compile): 2024-07-10 12:39:12.621121 => 2024-07-10 12:39:12.630687
[0m12:39:12.632592 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_find_incremental_datetime_field
[0m12:39:12.633112 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_column_count_in_subquery
[0m12:39:12.633831 [debug] [Thread-1 (]: Began running node test.etlcraft.test_get_from_default_dict
[0m12:39:12.634406 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (execute): 2024-07-10 12:39:12.634319 => 2024-07-10 12:39:12.634332
[0m12:39:12.635029 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_from_default_dict'
[0m12:39:12.635867 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_column_count_in_subquery
[0m12:39:12.636129 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_get_from_default_dict
[0m12:39:12.636560 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_min_max_date
[0m12:39:12.644386 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_get_from_default_dict"
[0m12:39:12.645439 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_min_max_date'
[0m12:39:12.646206 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_min_max_date
[0m12:39:12.656276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:12.657183 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (compile): 2024-07-10 12:39:12.636806 => 2024-07-10 12:39:12.656988
[0m12:39:12.657776 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_get_from_default_dict
[0m12:39:12.657962 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (execute): 2024-07-10 12:39:12.657912 => 2024-07-10 12:39:12.657924
[0m12:39:12.658483 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_get_from_default_dict
[0m12:39:12.658783 [debug] [Thread-1 (]: Began running node test.etlcraft.test_get_relations_dist
[0m12:39:12.659336 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_relations_dist'
[0m12:39:12.660289 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_get_relations_dist
[0m12:39:12.670197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:13.329624 [debug] [Thread-2 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_min_max_date: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_min_max_date"} */

    
    SELECT 
        table 
    
    FROM system.columns 
    
    WHERE 
        database ='test_dbt_test__audit' AND 
        table LIKE 'incremental_testsourcetypename_testtemplatename_%' AND 
        name='__date'

  ...
[0m12:39:13.331324 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_relations_dist: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_relations_dist"} */

    SELECT 
        table, 
        groupArray(name) AS fields
    
    FROM (
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
)
    
    WHERE database = '' AND table LIKE 'incremental_testsourcetypename_testtemplatename_%'
    GROUP BY table

...
[0m12:39:13.333683 [debug] [Thread-2 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:39:13.335830 [debug] [Thread-2 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_min_max_date: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_min_max_date"} */

SELECT max(toDate(min_date)) as date_from,
       max(toDate(max_date)) as date_to
FROM (

)
WHERE min_date > '1972-01-01'
...
[0m12:39:13.341581 [debug] [Thread-2 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_min_max_date"} */

SELECT max(toDate(min_date)) as date_from,
       max(toDate(max_date)) as date_to
FROM (

)
WHERE min_date > '1972-01-01'

[0m12:39:13.342963 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_min_max_date (compile): 2024-07-10 12:39:12.646416 => 2024-07-10 12:39:13.342824
[0m12:39:13.345942 [debug] [Thread-2 (]: Database Error in test test_get_min_max_date (tests/test_get_min_max_date.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 239 (')') (line 7, col 1): )
  WHERE min_date > '1972-01-01'
  
   FORMAT Native. Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 24.1.4.20 (official build))
[0m12:39:13.346484 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_min_max_date
[0m12:39:13.346852 [debug] [Thread-2 (]: Began running node test.etlcraft.test_json_list_keys
[0m12:39:13.347551 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_json_list_keys'
[0m12:39:13.349485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.etlcraft.test_json_list_keys)
[0m12:39:13.349916 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_json_list_keys
[0m12:39:13.357075 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_json_list_keys"
[0m12:39:13.358114 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m12:39:13.360102 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_get_relations_dist"
[0m12:39:13.360927 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_json_list_keys (compile): 2024-07-10 12:39:13.350071 => 2024-07-10 12:39:13.360776
[0m12:39:13.361325 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_relations_dist (compile): 2024-07-10 12:39:12.661097 => 2024-07-10 12:39:13.361225
[0m12:39:13.361825 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_json_list_keys
[0m12:39:13.362104 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_get_relations_dist
[0m12:39:13.362616 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_json_list_keys (execute): 2024-07-10 12:39:13.362484 => 2024-07-10 12:39:13.362512
[0m12:39:13.363126 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_relations_dist (execute): 2024-07-10 12:39:13.362990 => 2024-07-10 12:39:13.363013
[0m12:39:13.364247 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_json_list_keys
[0m12:39:13.365560 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_get_relations_dist
[0m12:39:13.366152 [debug] [Thread-2 (]: Began running node test.etlcraft.test_normalize
[0m12:39:13.366888 [debug] [Thread-1 (]: Began running node test.etlcraft.test_normalize_name
[0m12:39:13.367500 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_normalize'
[0m12:39:13.368296 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_normalize_name'
[0m12:39:13.368575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.etlcraft.test_normalize)
[0m12:39:13.368833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.etlcraft.test_normalize_name)
[0m12:39:13.369137 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_normalize
[0m12:39:13.369455 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_normalize_name
[0m12:39:13.376045 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_normalize (compile): 2024-07-10 12:39:13.369676 => 2024-07-10 12:39:13.375944
[0m12:39:13.392021 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_normalize_name"
[0m12:39:13.393720 [debug] [Thread-2 (]: Compilation Error in test test_normalize (tests/test_normalize.sql)
  No columns with names ending in "date", "datetime", "timestamp", "_time" were found in the relation "normalize_testsource_testtemplate_project_goals". Please ensure that your source data contains such a column for incremental processing.
  
  > in macro find_incremental_datetime_field (macros/other/find_incremental_datetime_field.sql)
  > called by macro normalize (macros/normalize/normalize.sql)
  > called by test test_normalize (tests/test_normalize.sql)
[0m12:39:13.394803 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_normalize
[0m12:39:13.395599 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (compile): 2024-07-10 12:39:13.376414 => 2024-07-10 12:39:13.395447
[0m12:39:13.396047 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_normalize_name
[0m12:39:13.396193 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (execute): 2024-07-10 12:39:13.396149 => 2024-07-10 12:39:13.396158
[0m12:39:13.396730 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_normalize_name
[0m12:39:13.397434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:13.398125 [debug] [MainThread]: Connection 'test.etlcraft.test_normalize_name' was left open.
[0m12:39:13.398892 [debug] [MainThread]: On test.etlcraft.test_normalize_name: Close
[0m12:39:13.399016 [debug] [MainThread]: Connection 'test.etlcraft.test_normalize' was left open.
[0m12:39:13.399169 [debug] [MainThread]: On test.etlcraft.test_normalize: Close
[0m12:39:13.399481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2601adba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2601b0c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2601b0c160>]}
[0m12:39:13.399724 [debug] [MainThread]: Flushing usage events
[0m12:39:14.006971 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_normalize (tests/test_normalize.sql)
    No columns with names ending in "date", "datetime", "timestamp", "_time" were found in the relation "normalize_testsource_testtemplate_project_goals". Please ensure that your source data contains such a column for incremental processing.
    
    > in macro find_incremental_datetime_field (macros/other/find_incremental_datetime_field.sql)
    > called by macro normalize (macros/normalize/normalize.sql)
    > called by test test_normalize (tests/test_normalize.sql)


============================== 2024-07-18 10:57:43.607806 | 8a3b349f-61bf-40d7-881b-0fe64b8ae0e7 ==============================
[0m10:57:43.607806 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:57:43.610720 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m10:57:43.611232 [debug] [MainThread]: Tracking: tracking
[0m10:57:43.613520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1c55bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1c559900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1c55bcd0>]}
[0m10:57:43.729814 [debug] [MainThread]: Executing "git --help"
[0m10:57:43.734394 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:57:43.734738 [debug] [MainThread]: STDERR: "b''"
[0m10:57:43.738673 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m10:57:43.739064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:44.054056 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m10:57:44.059196 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:44.060418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1ccf6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1ec54dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1cbba890>]}
[0m10:57:44.060924 [debug] [MainThread]: Flushing usage events
[0m10:57:44.652149 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:57:44.653069 [debug] [MainThread]: On debug: Close


============================== 2024-07-18 10:57:49.291487 | 1fe236c6-295f-4e42-892a-84fb7edc3b4f ==============================
[0m10:57:49.291487 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:57:49.293483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m10:57:49.293703 [debug] [MainThread]: Tracking: tracking
[0m10:57:49.296045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d094a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ce3fbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ce3fbb20>]}
[0m10:57:49.296522 [info ] [MainThread]: Start parsing.
[0m10:57:49.322562 [info ] [MainThread]: Dependencies loaded
[0m10:57:49.323586 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:57:49.337966 [info ] [MainThread]: ManifestLoader created
[0m10:57:49.394192 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 3 files changed.
[0m10:57:49.394677 [debug] [MainThread]: Partial parsing: added file: etlcraft://macros/join/join_appsflyer_events.sql
[0m10:57:49.394829 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://tests/test_normalize.sql
[0m10:57:49.394943 [debug] [MainThread]: Partial parsing: deleted file: etlcraft://tests/test_get_min_max_date.sql
[0m10:57:49.395159 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/normalize/normalize.sql
[0m10:57:49.395872 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/metadata/metadata.sql
[0m10:57:49.396098 [debug] [MainThread]: Partial parsing: updated file: etlcraft://macros/other/get_features.sql
[0m10:57:49.533546 [info ] [MainThread]: Manifest loaded
[0m10:57:49.534211 [info ] [MainThread]: Manifest checked
[0m10:57:49.534791 [info ] [MainThread]: Flat graph built
[0m10:57:49.535241 [info ] [MainThread]: Manifest finished loading
[0m10:57:49.535874 [info ] [MainThread]: Performance info: target/perf_info.json
[0m10:57:49.536279 [info ] [MainThread]: Done.
[0m10:57:49.536706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cdf1e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cdf1e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cdf1cd30>]}
[0m10:57:49.537106 [debug] [MainThread]: Flushing usage events


============================== 2024-07-18 10:57:56.430733 | a3812df3-e986-40db-a6ba-c228ba6a3e7b ==============================
[0m10:57:56.430733 [info ] [MainThread]: Running with dbt=1.4.7
[0m10:57:56.432685 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/natalia/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m10:57:56.432966 [debug] [MainThread]: Tracking: tracking
[0m10:57:56.435031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb9fba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afbfe9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afc5cce50>]}
[0m10:57:56.463630 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m10:57:56.511017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:56.511432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:56.519638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3812df3-e986-40db-a6ba-c228ba6a3e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb533f10>]}
[0m10:57:56.536691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3812df3-e986-40db-a6ba-c228ba6a3e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb6ebfa0>]}
[0m10:57:56.537682 [info ] [MainThread]: Found 0 models, 6 tests, 0 snapshots, 0 analyses, 546 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:57:56.537982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3812df3-e986-40db-a6ba-c228ba6a3e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb6fc040>]}
[0m10:57:56.539528 [info ] [MainThread]: 
[0m10:57:56.541871 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:57:56.542299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3812df3-e986-40db-a6ba-c228ba6a3e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb6ebc70>]}
[0m10:57:56.543061 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:57:56.543427 [info ] [MainThread]: 
[0m10:57:56.550245 [debug] [Thread-1 (]: Began running node test.etlcraft.test_find_incremental_datetime_field
[0m10:57:56.550905 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_column_count_in_subquery
[0m10:57:56.552035 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_find_incremental_datetime_field'
[0m10:57:56.553171 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_column_count_in_subquery'
[0m10:57:56.553710 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_find_incremental_datetime_field
[0m10:57:56.554256 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_column_count_in_subquery
[0m10:57:56.570250 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_column_count_in_subquery"
[0m10:57:56.591355 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_find_incremental_datetime_field"
[0m10:57:56.593049 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (compile): 2024-07-18 10:57:56.554678 => 2024-07-18 10:57:56.592785
[0m10:57:56.593673 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_find_incremental_datetime_field
[0m10:57:56.594307 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_find_incremental_datetime_field (execute): 2024-07-18 10:57:56.594142 => 2024-07-18 10:57:56.594180
[0m10:57:56.594731 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (compile): 2024-07-18 10:57:56.565265 => 2024-07-18 10:57:56.594638
[0m10:57:56.597638 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_find_incremental_datetime_field
[0m10:57:56.598346 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_column_count_in_subquery
[0m10:57:56.599000 [debug] [Thread-1 (]: Began running node test.etlcraft.test_get_from_default_dict
[0m10:57:56.599677 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_column_count_in_subquery (execute): 2024-07-18 10:57:56.599561 => 2024-07-18 10:57:56.599581
[0m10:57:56.600663 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_from_default_dict'
[0m10:57:56.602048 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_column_count_in_subquery
[0m10:57:56.602876 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_get_from_default_dict
[0m10:57:56.603793 [debug] [Thread-2 (]: Began running node test.etlcraft.test_get_relations_dist
[0m10:57:56.614616 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_get_from_default_dict"
[0m10:57:56.615569 [debug] [Thread-2 (]: Acquiring new clickhouse connection 'test.etlcraft.test_get_relations_dist'
[0m10:57:56.616255 [debug] [Thread-2 (]: Began compiling node test.etlcraft.test_get_relations_dist
[0m10:57:56.638843 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:57:56.639556 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (compile): 2024-07-18 10:57:56.604636 => 2024-07-18 10:57:56.639407
[0m10:57:56.639945 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_get_from_default_dict
[0m10:57:56.640654 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_get_from_default_dict (execute): 2024-07-18 10:57:56.640498 => 2024-07-18 10:57:56.640527
[0m10:57:56.641861 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_get_from_default_dict
[0m10:57:56.642479 [debug] [Thread-1 (]: Began running node test.etlcraft.test_json_list_keys
[0m10:57:56.643785 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_json_list_keys'
[0m10:57:56.644298 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_json_list_keys
[0m10:57:56.654090 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_json_list_keys"
[0m10:57:56.655505 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_json_list_keys (compile): 2024-07-18 10:57:56.644560 => 2024-07-18 10:57:56.655362
[0m10:57:56.656035 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_json_list_keys
[0m10:57:56.656921 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_json_list_keys (execute): 2024-07-18 10:57:56.656752 => 2024-07-18 10:57:56.656787
[0m10:57:56.658494 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_json_list_keys
[0m10:57:56.658988 [debug] [Thread-1 (]: Began running node test.etlcraft.test_normalize_name
[0m10:57:56.660730 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'test.etlcraft.test_normalize_name'
[0m10:57:56.661977 [debug] [Thread-1 (]: Began compiling node test.etlcraft.test_normalize_name
[0m10:57:56.683039 [debug] [Thread-1 (]: Writing injected SQL for node "test.etlcraft.test_normalize_name"
[0m10:57:56.684199 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (compile): 2024-07-18 10:57:56.662279 => 2024-07-18 10:57:56.684025
[0m10:57:56.684672 [debug] [Thread-1 (]: Began executing node test.etlcraft.test_normalize_name
[0m10:57:56.685065 [debug] [Thread-1 (]: Timing info for test.etlcraft.test_normalize_name (execute): 2024-07-18 10:57:56.684981 => 2024-07-18 10:57:56.685000
[0m10:57:56.685949 [debug] [Thread-1 (]: Finished running node test.etlcraft.test_normalize_name
[0m10:57:57.085992 [debug] [Thread-2 (]: dbt_clickhouse adapter: On test.etlcraft.test_get_relations_dist: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_local", "target_name": "dev", "node_id": "test.etlcraft.test_get_relations_dist"} */

    SELECT 
        table, 
        groupArray(name) AS fields
    
    FROM (
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'incremental_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col1'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col2'as name
    UNION all
    SELECT 
    '' as database,
    'normalize_testsourcetypename_testtemplatename' as table,
    'test_col3'as name
)
    
    WHERE database = '' AND table LIKE 'incremental_testsourcetypename_testtemplatename_%'
    GROUP BY table

...
[0m10:57:57.098719 [debug] [Thread-2 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:57.100242 [debug] [Thread-2 (]: Writing injected SQL for node "test.etlcraft.test_get_relations_dist"
[0m10:57:57.100988 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_relations_dist (compile): 2024-07-18 10:57:56.616588 => 2024-07-18 10:57:57.100868
[0m10:57:57.101393 [debug] [Thread-2 (]: Began executing node test.etlcraft.test_get_relations_dist
[0m10:57:57.101623 [debug] [Thread-2 (]: Timing info for test.etlcraft.test_get_relations_dist (execute): 2024-07-18 10:57:57.101553 => 2024-07-18 10:57:57.101570
[0m10:57:57.102487 [debug] [Thread-2 (]: Finished running node test.etlcraft.test_get_relations_dist
[0m10:57:57.104344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:57.104652 [debug] [MainThread]: Connection 'test.etlcraft.test_normalize_name' was properly closed.
[0m10:57:57.104795 [debug] [MainThread]: Connection 'test.etlcraft.test_get_relations_dist' was left open.
[0m10:57:57.104964 [debug] [MainThread]: On test.etlcraft.test_get_relations_dist: Close
[0m10:57:57.105505 [debug] [MainThread]: Command end result
[0m10:57:57.117945 [info ] [MainThread]: Done.
[0m10:57:57.118793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb9fbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb59df00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afb59e4d0>]}
[0m10:57:57.119195 [debug] [MainThread]: Flushing usage events
